(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{385:function(t,e,a){"use strict";a.r(e);var r=a(45),v=Object(r.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"merchant-rules"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#merchant-rules"}},[t._v("#")]),t._v(" Merchant Rules")]),t._v(" "),a("h2",{attrs:{id:"api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#api"}},[t._v("#")]),t._v(" API")]),t._v(" "),a("p",[t._v("A merchant can have rules added to them. These rules can control if authorizations, captures, refunds or voids get rejected based on some criteria. "),a("RouterLink",{attrs:{to:"/integrate/acquiring/rules.html#how-to-write-a-rule"}},[t._v("Read more of how to write a Rule")]),t._v(".")],1),t._v(" "),a("h3",{attrs:{id:"patching-rules"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#patching-rules"}},[t._v("#")]),t._v(" Patching Rules")]),t._v(" "),a("p",[t._v("Only a private or agent bearer token is authorized to make this call.")]),t._v(" "),a("p",[t._v("Example PATCH request:")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("div",{staticClass:"highlight-lines"},[a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('PATCH /merchant/:id/rule\n\nHost: api.payfunc.com\nContent-Type: application/json\nAuthorization: Bearer <private or agent access_token>\n\n{\n    "agent": ["reject refund if merchant.refundable<0"],\n    "merchant": [\n        "reject capture if !authorization.currency:(EUR|SEK)",\n        "reject capture if authorization.currency:(EUR) merchant.captured > 25000",\n        "reject capture if authorization.currency:(SEK) merchant.captured > 250000"\n    ]\n}\n')])])]),a("h3",{attrs:{id:"putting-rules"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#putting-rules"}},[t._v("#")]),t._v(" Putting Rules")]),t._v(" "),a("p",[t._v('Only an acquirer can make this call (agent access token with id="master").')]),t._v(" "),a("p",[t._v("Example PUT Rule request:")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("div",{staticClass:"highlight-lines"},[a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('PUT /merchant/:id/rule\n\nHost: api.payfunc.com\nContent-Type: application/json\nAuthorization: Bearer <master access_token>\n\n{\n    "master": ["reject capture if merchant.captured > 250000"],\n    "agent": ["reject refund if merchant.refundable<0"]\n}\n')])])]),a("h2",{attrs:{id:"how-to-write-a-rule"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-write-a-rule"}},[t._v("#")]),t._v(" How to write a Rule")]),t._v(" "),a("p",[t._v("A Rule is a string that can be parsed and divided into the folloing parts.")]),t._v(" "),a("p",[a("code",[t._v("action")]),t._v(" "),a("code",[t._v("event")]),t._v(" if "),a("code",[t._v("condition")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("action")]),t._v(" is as of yet limited to "),a("code",[t._v('"reject"')]),t._v(".")]),t._v(" "),a("li",[a("code",[t._v("event")]),t._v(" can be set as "),a("code",[t._v('"authorization"')]),t._v(", "),a("code",[t._v('"capture"')]),t._v(", "),a("code",[t._v('"refund"')]),t._v(" or "),a("code",[t._v('"void"')]),t._v(".")]),t._v(" "),a("li",[a("code",[t._v("condition")]),t._v(" is a boolean expression.")])]),t._v(" "),a("p",[t._v("Example rule:")]),t._v(" "),a("p",[a("code",[t._v('"reject capture if merchant.captured > 250000"')])]),t._v(" "),a("h3",{attrs:{id:"condition"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#condition"}},[t._v("#")]),t._v(" Condition")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Operator")]),t._v(" "),a("th",[t._v("Description")]),t._v(" "),a("th",[t._v("Example")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("code",[t._v(".")])]),t._v(" "),a("td",[t._v("Property of")]),t._v(" "),a("td",[a("code",[t._v("merchant.captured")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("+")])]),t._v(" "),a("td",[t._v("Addition")]),t._v(" "),a("td",[a("code",[t._v("merchant.refundable + 2500")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("-")])]),t._v(" "),a("td",[t._v("Subtraction")]),t._v(" "),a("td",[a("code",[t._v("merchant.settled - 100")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("*")])]),t._v(" "),a("td",[t._v("Multiplication")]),t._v(" "),a("td",[a("code",[t._v("merchant.captured * 2")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v(":")])]),t._v(" "),a("td",[t._v("Equal to")]),t._v(" "),a("td",[a("code",[t._v("merchant.scheme:visa")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("!")])]),t._v(" "),a("td",[t._v("Not")]),t._v(" "),a("td",[a("code",[t._v("!authorization.verification:verified")])])]),t._v(" "),a("tr",[a("td",[t._v("..."),a("code",[t._v("*")])]),t._v(" "),a("td",[t._v("Ends with")]),t._v(" "),a("td",[a("code",[t._v("authorization.created:2021-05-31*")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("has(")]),t._v("..."),a("code",[t._v(")")])]),t._v(" "),a("td",[t._v("Has property")]),t._v(" "),a("td",[a("code",[t._v("authorization:has(currency)")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("<")])]),t._v(" "),a("td",[t._v("Less than")]),t._v(" "),a("td",[a("code",[t._v("merchant.refundable < -3000")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("<=")])]),t._v(" "),a("td",[t._v("Less than or equal to")]),t._v(" "),a("td",[a("code",[t._v("authorization.captured.amount <= 5000")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v(">")])]),t._v(" "),a("td",[t._v("Greater than")]),t._v(" "),a("td",[a("code",[t._v("authorization.amount > 225")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v(">=")])]),t._v(" "),a("td",[t._v("Greater than or equal to")]),t._v(" "),a("td",[a("code",[t._v("merchant.captured >= 250000")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("|")])]),t._v(" "),a("td",[t._v("Or")]),t._v(" "),a("td",[a("code",[t._v("!authorization.currency:(EUR) | !authorization.card.csc:present")])])]),t._v(" "),a("tr",[a("td",[a("code")]),t._v(" "),a("td",[t._v("And")]),t._v(" "),a("td",[a("code",[t._v("!authorization.recurring:subsequent !authorization.card.csc:present")])])])])]),t._v(" "),a("p",[t._v("Spacing is important when writting a condition.")]),t._v(" "),a("p",[t._v("When writing "),a("code",[t._v("20-12-24")]),t._v(" is a string whereas "),a("code",[t._v("20 - 12 - 24")]),t._v(" is a number.")]),t._v(" "),a("p",[t._v("Space can also be used as an AND-operator to chain several conditions together.")]),t._v(" "),a("h3",{attrs:{id:"rules"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rules"}},[t._v("#")]),t._v(" Rules")]),t._v(" "),a("p",[t._v("A "),a("code",[t._v("Rules")]),t._v(" object is of type "),a("code",[t._v("Record<string, Rule[]>")]),t._v(". The key specifies who has made the rule. The key can for example be "),a("code",[t._v('"merchant"')]),t._v(", "),a("code",[t._v('"agent"')]),t._v(" or "),a("code",[t._v('"master"')]),t._v(". The Rules specifeid by the key "),a("code",[t._v('"master"')]),t._v(" are rules setup by the acquirer.")])])}),[],!1,null,null,null);e.default=v.exports}}]);